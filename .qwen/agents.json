#  Cerlita AI Agents - Configuraci贸n Completa

## Agentes Disponibles para Cerlita

### 1. **NostrProtocolAgent** - Experto en Protocolo Nostr
**Prop贸sito**: Implementaci贸n correcta de NIPs, optimizaci贸n de relays, cifrado

**Tareas autom谩ticas**:
- Verificar implementaci贸n de NIP-01, NIP-04, NIP-44
- Optimizar conexi贸n a relays (5-10 relays balanceados)
- Sugerir filtros de suscripci贸n eficientes
- Validar estructura de eventos kind 4, 40, 30315

**Cu谩ndo activar**:
- Errores de conexi贸n a relays
- Mensajes no se env铆an/reciben
- Optimizaci贸n de ancho de banda
- Implementaci贸n de nuevos NIPs

**Comandos**:
```
@nostr-agent: "Verifica la implementaci贸n de NIP-44"
@nostr-agent: "Optimiza los filtros de suscripci贸n"
@nostr-agent: "驴Cu谩les relays son m谩s r谩pidos para Cuba?"
```

---

### 2. **FlutterPerformanceAgent** - Optimizaci贸n de Rendimiento
**Prop贸sito**: Mejorar performance en dispositivos de gama baja, optimizar memoria

**Tareas autom谩ticas**:
- Analizar uso de memoria (8GB RAM en Codespaces)
- Optimizar builds de Flutter
- Sugerir lazy loading para listas de mensajes
- Implementar caching eficiente

**Cu谩ndo activar**:
- App lenta en carga
- Alto consumo de memoria
- Build times largos
- Problemas de renderizado

**Comandos**:
```
@perf-agent: "Optimiza el uso de memoria"
@perf-agent: "驴Por qu茅 el build tarda tanto?"
@perf-agent: "Implementa lazy loading en chats"
```

---

### 3. **OfflineFirstAgent** - Sincronizaci贸n y Cache
**Prop贸sito**: Estrategias offline-first, sync con Hive, reconexi贸n

**Tareas autom谩ticas**:
- Verificar que todo se guarda en Hive primero
- Implementar sync queue para mensajes pendientes
- Optimizar reconexi贸n con backoff exponencial
- Manejar conflictos de sincronizaci贸n

**Cu谩ndo activar**:
- Mensajes se pierden offline
- Sync no funciona al reconectar
- Conflictos en datos de Hive
- Problemas de conectividad intermitente

**Comandos**:
```
@offline-agent: "Revisa la sync queue"
@offline-agent: "驴Los mensajes se guardan local primero?"
@offline-agent: "Optimiza la reconexi贸n"
```

---

### 4. **SecurityAgent** - Seguridad y Cifrado
**Prop贸sito**: Auditor铆a de seguridad, manejo de claves, cifrado NIP-44

**Tareas autom谩ticas**:
- Auditar manejo de private keys (nsec)
- Verificar cifrado de mensajes
- Prevenir leaks de claves en logs
- Validar firma de eventos

**Cu谩ndo activar**:
- Dudas sobre seguridad de claves
- Implementaci贸n de cifrado
- Auditor铆a de seguridad
- Vulnerabilidades potenciales

**Comandos**:
```
@security-agent: "Audita el manejo de nsec"
@security-agent: "驴El cifrado NIP-44 es correcto?"
@security-agent: "Revisa vulnerabilidades"
```

---

### 5. **UIUXAgent** - Experiencia de Usuario
**Prop贸sito**: Mejorar UX, temas, accesibilidad, feedback visual

**Tareas autom谩ticas**:
- Sugerir mejoras de UI para los 5 temas
- Implementar loading states
- Mejorar feedback de errores
- Optimizar para pantallas peque帽as

**Cu谩ndo activar**:
- Mejoras de dise帽o
- Problemas de usabilidad
- Nuevas pantallas
- Accesibilidad

**Comandos**:
```
@ui-agent: "Mejora el feedback de env铆o de mensajes"
@ui-agent: "驴C贸mo mostrar estado de conexi贸n?"
@ui-agent: "Optimiza para m贸viles"
```

---

##  Agentes Autom谩ticos (Se activan solos)

### AutoNostrOptimizer
**Se activa cuando**:
- Detecta >10 relays configurados
- Conexiones lentas (>5s)
- M煤ltiples errores de WebSocket

**Acciones autom谩ticas**:
- Reduce a 5-6 relays 贸ptimos
- Prioriza relays cercanos
- Implementa circuit breaker

---

### AutoHiveOptimizer
**Se activa cuando**:
- Hive box >1000 mensajes
- Query times >100ms
- Memoria >500MB

**Acciones autom谩ticas**:
- Sugiere paginaci贸n
- Implementa 铆ndices
- Limpieza autom谩tica de mensajes viejos

---

### AutoBackgroundService
**Se activa cuando**:
- WebSocket se cierra
- App pasa a background
- Sin actividad >30s

**Acciones autom谩ticas**:
- Reconecta con backoff
- Mantiene heartbeat
- Notifica reconexi贸n

---

##  Configuraci贸n de Agentes en .qwen/agents.json

```json
{
  "agents": {
    "nostr": {
      "enabled": true,
      "autoActivate": ["relay-errors", "nip-implementation"],
      "relays": {
        "maxConnections": 6,
        "timeout": 5000,
        "reconnectBackoff": [1000, 2000, 4000, 8000]
      }
    },
    "performance": {
      "enabled": true,
      "autoActivate": ["slow-build", "high-memory"],
      "thresholds": {
        "maxMemoryMB": 500,
        "maxBuildTimeSec": 120
      }
    },
    "offline": {
      "enabled": true,
      "autoActivate": ["sync-failure", "offline-detected"],
      "hive": {
        "maxMessagesPerBox": 1000,
        "cleanupDays": 30
      }
    },
    "security": {
      "enabled": true,
      "autoActivate": ["key-handling", "encryption"],
      "audit": {
        "checkKeyLeaks": true,
        "validateEncryption": true
      }
    }
  }
}
```

---

##  Flujo de Trabajo con Agentes

### Ejemplo 1: Error al enviar mensaje
```
1. Usuario: "Error: No hay claves inicializadas"
2. Auto-activa: @security-agent (audita manejo de claves)
3. Auto-activa: @nostr-agent (verifica init de NostrService)
4. Soluci贸n: NostrService.init(privateKey, force: true)
5. Auto-actualiza: Skill con la soluci贸n encontrada
```

### Ejemplo 2: Mensajes no llegan
```
1. Usuario: "Los mensajes no se reciben"
2. Auto-activa: @offline-agent (revisa sync)
3. Auto-activa: @nostr-agent (verifica suscripciones)
4. Soluci贸n: Verificar filtros de suscripci贸n kind 4
5. Auto-actualiza: C贸digo con filtros corregidos
```

---

##  Aprendizaje Autom谩tico de Agentes

Cada agente **aprende autom谩ticamente** de:
- Errores corregidos
- Soluciones exitosas
- Patrones de c贸digo
- Preferencias del desarrollador

**Se actualiza solo**:
- Skills en `.qwen/skills/`
- Configuraci贸n en `.qwen/agents.json`
- Historial en `.qwen/history.md`

---

**Los agentes trabajan en segundo plano - no necesitas activarlos manualmente a menos que quieras algo espec铆fico.** 
